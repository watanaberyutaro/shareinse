{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///Users/watanaberyuutarou/Desktop/3125%E6%98%A0%E5%83%8F/myProject/shareinse/assign-management/app/%28protected%29/assignments/AssignmentForm.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { X, Calendar, DollarSign, MapPin, Building2, Users } from 'lucide-react'\nimport { createClient } from '@/lib/supabase/client'\nimport { format } from 'date-fns'\n\ninterface AssignmentFormProps {\n  assignment?: any\n  staffList: any[]\n  companies: any[]\n  currentUserId: string\n  onClose: () => void\n  onSave: () => void\n}\n\nexport default function AssignmentForm({\n  assignment,\n  staffList,\n  companies,\n  currentUserId,\n  onClose,\n  onSave\n}: AssignmentFormProps) {\n  const supabase = createClient()\n  const [isLoading, setIsLoading] = useState(false)\n  const [formData, setFormData] = useState({\n    project_name: '',\n    project_location: '',\n    project_type: 'continuous' as 'spot' | 'continuous',\n    staff_name: '',\n    staff_company: '',\n    client_company_id: '',\n    vendor_company_id: '',\n    daily_rate: 0,\n    cost_rate: 0,\n    work_month: format(new Date(), 'yyyy-MM'),\n    work_days: 0,\n    work_dates: [] as string[],\n    project_manager_id: '',\n    staff_manager_id: '',\n  })\n\n  // スポット案件用の選択された日付\n  const [selectedDates, setSelectedDates] = useState<Set<string>>(new Set())\n\n  useEffect(() => {\n    if (assignment) {\n      console.log('Loading assignment for edit:', assignment)\n      \n      // work_monthの処理 - YYYY-MM-DD形式からYYYY-MM形式に変換\n      let workMonth = format(new Date(), 'yyyy-MM')\n      if (assignment.work_month) {\n        // YYYY-MM-DD または YYYY-MM 形式の両方に対応\n        if (assignment.work_month.length === 10) {\n          // YYYY-MM-DD形式の場合\n          workMonth = assignment.work_month.substring(0, 7)\n        } else if (assignment.work_month.length === 7) {\n          // YYYY-MM形式の場合\n          workMonth = assignment.work_month\n        }\n      }\n      \n      // 編集モードの場合、既存データをフォームにセット\n      setFormData({\n        project_name: assignment.project_name || '',\n        project_location: assignment.project_location || '',\n        project_type: assignment.project_type || 'continuous',\n        staff_name: assignment.staff_name || '',\n        staff_company: assignment.staff_company || '',\n        client_company_id: assignment.client_company_id || '',\n        vendor_company_id: assignment.vendor_company_id || '',\n        daily_rate: assignment.daily_rate || 0,\n        cost_rate: assignment.cost_rate || 0,\n        work_month: workMonth,\n        work_days: assignment.work_days || 0,\n        work_dates: assignment.work_dates || [],\n        project_manager_id: assignment.project_manager_id || '',\n        staff_manager_id: assignment.staff_manager_id || '',\n      })\n      \n      // スポット案件の日付を設定\n      if (assignment.work_dates && assignment.work_dates.length > 0) {\n        console.log('Setting selected dates:', assignment.work_dates)\n        setSelectedDates(new Set(assignment.work_dates))\n      }\n    } else {\n      // 新規作成モードの場合、デフォルト値を設定\n      setFormData({\n        project_name: '',\n        project_location: '',\n        project_type: 'continuous',\n        staff_name: '',\n        staff_company: '',\n        client_company_id: '',\n        vendor_company_id: '',\n        daily_rate: 0,\n        cost_rate: 0,\n        work_month: format(new Date(), 'yyyy-MM'),\n        work_days: 0,\n        work_dates: [],\n        project_manager_id: '',\n        staff_manager_id: '',\n      })\n      setSelectedDates(new Set())\n    }\n  }, [assignment])\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setIsLoading(true)\n\n    try {\n      // バリデーション\n      if (formData.project_type === 'spot' && selectedDates.size === 0) {\n        alert('スポット案件の場合は稼働日を選択してください')\n        setIsLoading(false)\n        return\n      }\n\n      if (formData.project_type === 'continuous' && formData.work_days <= 0) {\n        alert('継続案件の場合は稼働日数を入力してください')\n        setIsLoading(false)\n        return\n      }\n\n      // 日付フォーマットの確認と修正\n      const workMonth = formData.work_month.includes('-01') \n        ? formData.work_month \n        : formData.work_month + '-01'\n\n      const data = {\n        project_name: formData.project_name.trim(),\n        project_location: formData.project_location.trim(),\n        project_type: formData.project_type,\n        staff_name: formData.staff_name.trim(),\n        staff_company: formData.staff_company?.trim() || null,\n        client_company_id: formData.client_company_id || null,\n        vendor_company_id: formData.vendor_company_id || null,\n        daily_rate: Number(formData.daily_rate) || 0,\n        cost_rate: Number(formData.cost_rate) || 0,\n        work_month: workMonth,\n        work_dates: formData.project_type === 'spot' ? Array.from(selectedDates).sort() : null,\n        work_days: formData.project_type === 'continuous' ? Number(formData.work_days) : null,\n        project_manager_id: formData.project_manager_id || null,\n        staff_manager_id: formData.staff_manager_id || null,\n      }\n\n      console.log('Submitting data:', data)\n\n      if (assignment) {\n        // 更新\n        const { error } = await supabase\n          .from('assignments')\n          .update({\n            ...data,\n            updated_by: currentUserId,\n            updated_at: new Date().toISOString(),\n          })\n          .eq('id', assignment.id)\n\n        if (error) {\n          console.error('Update error:', error)\n          throw error\n        }\n        console.log('Assignment updated successfully')\n      } else {\n        // 新規作成\n        const { error } = await supabase\n          .from('assignments')\n          .insert({\n            ...data,\n            created_by: currentUserId,\n            created_at: new Date().toISOString(),\n          })\n\n        if (error) {\n          console.error('Insert error:', error)\n          throw error\n        }\n        console.log('Assignment created successfully')\n      }\n\n      onSave()\n    } catch (error: any) {\n      console.error('Error saving assignment:', error)\n      alert(`保存に失敗しました: ${error.message || '不明なエラー'}`)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  // カレンダーの日付を生成\n  const generateCalendarDates = () => {\n    const year = parseInt(formData.work_month.split('-')[0])\n    const month = parseInt(formData.work_month.split('-')[1]) - 1\n    const firstDay = new Date(year, month, 1)\n    const lastDay = new Date(year, month + 1, 0)\n    const dates = []\n\n    for (let d = new Date(firstDay); d <= lastDay; d.setDate(d.getDate() + 1)) {\n      dates.push(new Date(d))\n    }\n\n    return dates\n  }\n\n  const toggleDate = (date: string) => {\n    const newDates = new Set(selectedDates)\n    if (newDates.has(date)) {\n      newDates.delete(date)\n    } else {\n      newDates.add(date)\n    }\n    setSelectedDates(newDates)\n    // work_datesも同期的に更新\n    setFormData(prev => ({\n      ...prev,\n      work_dates: Array.from(newDates).sort()\n    }))\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\n        <div className=\"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center\">\n          <h2 className=\"text-xl font-semibold\">\n            {assignment ? 'アサイン編集' : '新規アサイン登録'}\n          </h2>\n          <button onClick={onClose} className=\"text-gray-400 hover:text-gray-600\">\n            <X className=\"h-6 w-6\" />\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"p-6 space-y-6\">\n          {/* 基本情報 */}\n          <div>\n            <h3 className=\"text-lg font-medium mb-4\">基本情報</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  案件名 *\n                </label>\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.project_name}\n                  onChange={(e) => setFormData({ ...formData, project_name: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  案件場所 *\n                </label>\n                <div className=\"relative\">\n                  <MapPin className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n                  <input\n                    type=\"text\"\n                    required\n                    value={formData.project_location}\n                    onChange={(e) => setFormData({ ...formData, project_location: e.target.value })}\n                    className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  案件種別 *\n                </label>\n                <select\n                  value={formData.project_type}\n                  onChange={(e) => setFormData({ ...formData, project_type: e.target.value as any })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                >\n                  <option value=\"continuous\">継続</option>\n                  <option value=\"spot\">スポット</option>\n                </select>\n              </div>\n            </div>\n          </div>\n\n          {/* スタッフ情報 */}\n          <div>\n            <h3 className=\"text-lg font-medium mb-4\">スタッフ情報</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  スタッフ名 *\n                </label>\n                <input\n                  type=\"text\"\n                  required\n                  value={formData.staff_name}\n                  onChange={(e) => setFormData({ ...formData, staff_name: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  所属会社\n                </label>\n                <input\n                  type=\"text\"\n                  value={formData.staff_company}\n                  onChange={(e) => setFormData({ ...formData, staff_company: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* 企業情報 */}\n          <div>\n            <h3 className=\"text-lg font-medium mb-4\">企業情報</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  案件元企業\n                </label>\n                <select\n                  value={formData.client_company_id}\n                  onChange={(e) => setFormData({ ...formData, client_company_id: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                >\n                  <option value=\"\">選択してください</option>\n                  {companies.filter(c => c.company_type === 'client' || c.company_type === 'both').map(company => (\n                    <option key={company.id} value={company.id}>{company.name}</option>\n                  ))}\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  人財元企業\n                </label>\n                <select\n                  value={formData.vendor_company_id}\n                  onChange={(e) => setFormData({ ...formData, vendor_company_id: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                >\n                  <option value=\"\">選択してください</option>\n                  {companies.filter(c => c.company_type === 'vendor' || c.company_type === 'both').map(company => (\n                    <option key={company.id} value={company.id}>{company.name}</option>\n                  ))}\n                </select>\n              </div>\n            </div>\n          </div>\n\n          {/* 金額情報 */}\n          <div>\n            <h3 className=\"text-lg font-medium mb-4\">金額情報</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  稼働単価（円/日） *\n                </label>\n                <div className=\"relative\">\n                  <DollarSign className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n                  <input\n                    type=\"number\"\n                    required\n                    value={formData.daily_rate}\n                    onChange={(e) => setFormData({ ...formData, daily_rate: parseInt(e.target.value) || 0 })}\n                    className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  卸単価（円/日） *\n                </label>\n                <div className=\"relative\">\n                  <DollarSign className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4\" />\n                  <input\n                    type=\"number\"\n                    required\n                    value={formData.cost_rate}\n                    onChange={(e) => setFormData({ ...formData, cost_rate: parseInt(e.target.value) || 0 })}\n                    className=\"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n\n          {/* 稼働情報 */}\n          <div>\n            <h3 className=\"text-lg font-medium mb-4\">稼働情報</h3>\n            <div className=\"mb-4\">\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                稼働月 *\n              </label>\n              <input\n                type=\"month\"\n                required\n                value={formData.work_month}\n                onChange={(e) => setFormData({ ...formData, work_month: e.target.value })}\n                className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n              />\n            </div>\n\n            {formData.project_type === 'continuous' ? (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  稼働日数 *\n                </label>\n                <input\n                  type=\"number\"\n                  required\n                  value={formData.work_days}\n                  onChange={(e) => setFormData({ ...formData, work_days: parseInt(e.target.value) || 0 })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                />\n              </div>\n            ) : (\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  稼働日選択（{selectedDates.size}日選択中）\n                </label>\n                <div className=\"grid grid-cols-7 gap-1 p-4 border border-gray-300 rounded-lg\">\n                  {['日', '月', '火', '水', '木', '金', '土'].map(day => (\n                    <div key={day} className=\"text-center text-xs font-medium text-gray-500 pb-2\">\n                      {day}\n                    </div>\n                  ))}\n                  {generateCalendarDates().map(date => {\n                    const dateStr = format(date, 'yyyy-MM-dd')\n                    const isSelected = selectedDates.has(dateStr)\n                    const dayOfWeek = date.getDay()\n                    const isWeekend = dayOfWeek === 0 || dayOfWeek === 6\n                    \n                    return (\n                      <button\n                        key={dateStr}\n                        type=\"button\"\n                        onClick={() => toggleDate(dateStr)}\n                        className={`\n                          p-2 text-sm rounded transition\n                          ${isSelected \n                            ? 'bg-blue-500 text-white' \n                            : isWeekend\n                              ? 'bg-gray-50 text-gray-400 hover:bg-gray-100'\n                              : 'hover:bg-gray-100'\n                          }\n                        `}\n                        style={{\n                          gridColumnStart: date.getDate() === 1 ? dayOfWeek + 1 : undefined\n                        }}\n                      >\n                        {date.getDate()}\n                      </button>\n                    )\n                  })}\n                </div>\n              </div>\n            )}\n          </div>\n\n          {/* 担当者情報 */}\n          <div>\n            <h3 className=\"text-lg font-medium mb-4\">担当者情報</h3>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  案件担当者\n                </label>\n                <select\n                  value={formData.project_manager_id}\n                  onChange={(e) => setFormData({ ...formData, project_manager_id: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                >\n                  <option value=\"\">選択してください</option>\n                  {staffList.map(staff => (\n                    <option key={staff.id} value={staff.id}>{staff.display_name}</option>\n                  ))}\n                </select>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\n                  人材担当者\n                </label>\n                <select\n                  value={formData.staff_manager_id}\n                  onChange={(e) => setFormData({ ...formData, staff_manager_id: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n                >\n                  <option value=\"\">選択してください</option>\n                  {staffList.map(staff => (\n                    <option key={staff.id} value={staff.id}>{staff.display_name}</option>\n                  ))}\n                </select>\n              </div>\n            </div>\n          </div>\n\n          {/* ボタン */}\n          <div className=\"flex justify-end gap-4 pt-4 border-t\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition\"\n            >\n              キャンセル\n            </button>\n            <button\n              type=\"submit\"\n              disabled={isLoading}\n              className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition\"\n            >\n              {isLoading ? '保存中...' : '保存'}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1012, "column": 0}, "map": {"version":3,"sources":["file:///Users/watanaberyuutarou/Desktop/3125%E6%98%A0%E5%83%8F/myProject/shareinse/assign-management/app/%28protected%29/assignments/AssignmentsClient.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { Plus, Edit2, Trash2, Search, Filter, Calendar } from 'lucide-react'\nimport { format } from 'date-fns'\nimport { ja } from 'date-fns/locale'\nimport AssignmentForm from './AssignmentForm'\nimport { createClient } from '@/lib/supabase/client'\nimport { useRouter } from 'next/navigation'\n\ninterface AssignmentsClientProps {\n  assignments: any[]\n  staffList: any[]\n  companies: any[]\n  currentUserId: string\n  userRole: 'admin' | 'leader' | 'member'\n}\n\nexport default function AssignmentsClient({\n  assignments,\n  staffList,\n  companies,\n  currentUserId,\n  userRole\n}: AssignmentsClientProps) {\n  const router = useRouter()\n  const supabase = createClient()\n  const [searchTerm, setSearchTerm] = useState('')\n  const [filterMonth, setFilterMonth] = useState('')\n  const [filterType, setFilterType] = useState<'all' | 'spot' | 'continuous'>('all')\n  const [isFormOpen, setIsFormOpen] = useState(false)\n  const [editingAssignment, setEditingAssignment] = useState<any>(null)\n\n  // フィルタリング\n  const filteredAssignments = assignments.filter(assignment => {\n    const matchesSearch = \n      assignment.project_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      assignment.staff_name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n      assignment.project_location.toLowerCase().includes(searchTerm.toLowerCase())\n    \n    const matchesMonth = !filterMonth || assignment.work_month.startsWith(filterMonth)\n    const matchesType = filterType === 'all' || assignment.project_type === filterType\n    \n    return matchesSearch && matchesMonth && matchesType\n  })\n\n  const handleDelete = async (id: string) => {\n    if (!confirm('このアサインを削除してもよろしいですか？')) return\n\n    try {\n      const { error } = await supabase\n        .from('assignments')\n        .delete()\n        .eq('id', id)\n\n      if (error) {\n        console.error('Delete error:', error)\n        alert(`削除に失敗しました: ${error.message}`)\n      } else {\n        router.refresh()\n      }\n    } catch (error: any) {\n      console.error('Delete error:', error)\n      alert(`削除に失敗しました: ${error.message || '不明なエラー'}`)\n    }\n  }\n\n  const canEdit = (assignment: any) => {\n    return userRole === 'admin' || \n           userRole === 'leader' || \n           assignment.created_by === currentUserId\n  }\n\n  const formatCurrency = (value: number) => {\n    return new Intl.NumberFormat('ja-JP', {\n      style: 'currency',\n      currency: 'JPY',\n      minimumFractionDigits: 0\n    }).format(value)\n  }\n\n  const calculateRevenue = (assignment: any) => {\n    if (assignment.project_type === 'continuous') {\n      return assignment.daily_rate * (assignment.work_days || 0)\n    } else {\n      return assignment.daily_rate * (assignment.work_dates?.length || 0)\n    }\n  }\n\n  const calculateProfit = (assignment: any) => {\n    const revenue = calculateRevenue(assignment)\n    const cost = assignment.project_type === 'continuous'\n      ? assignment.cost_rate * (assignment.work_days || 0)\n      : assignment.cost_rate * (assignment.work_dates?.length || 0)\n    return revenue - cost\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* ヘッダー */}\n      <div className=\"flex justify-between items-center\">\n        <h1 className=\"text-3xl font-bold text-gray-800\">アサイン管理</h1>\n        <button\n          onClick={() => {\n            setEditingAssignment(null)\n            setIsFormOpen(true)\n          }}\n          className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition flex items-center gap-2\"\n        >\n          <Plus className=\"h-5 w-5\" />\n          新規登録\n        </button>\n      </div>\n\n      {/* フィルター */}\n      <div className=\"bg-white rounded-lg shadow p-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5\" />\n            <input\n              type=\"text\"\n              placeholder=\"検索...\"\n              value={searchTerm}\n              onChange={(e) => setSearchTerm(e.target.value)}\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n            />\n          </div>\n\n          <div className=\"relative\">\n            <Calendar className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5\" />\n            <input\n              type=\"month\"\n              value={filterMonth}\n              onChange={(e) => setFilterMonth(e.target.value)}\n              className=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n            />\n          </div>\n\n          <select\n            value={filterType}\n            onChange={(e) => setFilterType(e.target.value as any)}\n            className=\"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none\"\n          >\n            <option value=\"all\">すべて</option>\n            <option value=\"continuous\">継続</option>\n            <option value=\"spot\">スポット</option>\n          </select>\n\n          <div className=\"text-sm text-gray-600 flex items-center\">\n            {filteredAssignments.length} 件のアサイン\n          </div>\n        </div>\n      </div>\n\n      {/* テーブル */}\n      <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  案件情報\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  スタッフ\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  稼働期間\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  担当者\n                </th>\n                <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  売上/利益\n                </th>\n                <th className=\"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  操作\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {filteredAssignments.map((assignment) => (\n                <tr key={assignment.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4\">\n                    <div>\n                      <div className=\"text-sm font-medium text-gray-900\">\n                        {assignment.project_name}\n                      </div>\n                      <div className=\"text-sm text-gray-500\">\n                        {assignment.project_location}\n                      </div>\n                      <span className={`inline-flex px-2 py-1 text-xs rounded-full mt-1 ${\n                        assignment.project_type === 'continuous'\n                          ? 'bg-green-100 text-green-700'\n                          : 'bg-blue-100 text-blue-700'\n                      }`}>\n                        {assignment.project_type === 'continuous' ? '継続' : 'スポット'}\n                      </span>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4\">\n                    <div className=\"text-sm text-gray-900\">{assignment.staff_name}</div>\n                    {assignment.staff_company && (\n                      <div className=\"text-sm text-gray-500\">{assignment.staff_company}</div>\n                    )}\n                  </td>\n                  <td className=\"px-6 py-4\">\n                    <div className=\"text-sm text-gray-900\">\n                      {format(new Date(assignment.work_month), 'yyyy年M月', { locale: ja })}\n                    </div>\n                    <div className=\"text-sm text-gray-500\">\n                      {assignment.project_type === 'continuous'\n                        ? `${assignment.work_days}日`\n                        : `${assignment.work_dates?.length || 0}日`}\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4\">\n                    <div className=\"text-sm\">\n                      <div className=\"text-gray-900\">\n                        案件: {assignment.project_manager?.display_name || '-'}\n                      </div>\n                      <div className=\"text-gray-500\">\n                        人材: {assignment.staff_manager?.display_name || '-'}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 text-right\">\n                    <div className=\"text-sm\">\n                      <div className=\"text-gray-900 font-medium\">\n                        {formatCurrency(calculateRevenue(assignment))}\n                      </div>\n                      <div className=\"text-green-600\">\n                        {formatCurrency(calculateProfit(assignment))}\n                      </div>\n                    </div>\n                  </td>\n                  <td className=\"px-6 py-4 text-center\">\n                    {canEdit(assignment) && (\n                      <div className=\"flex justify-center gap-2\">\n                        <button\n                          onClick={() => {\n                            setEditingAssignment(assignment)\n                            setIsFormOpen(true)\n                          }}\n                          className=\"text-blue-600 hover:text-blue-800\"\n                        >\n                          <Edit2 className=\"h-4 w-4\" />\n                        </button>\n                        <button\n                          onClick={() => handleDelete(assignment.id)}\n                          className=\"text-red-600 hover:text-red-800\"\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </button>\n                      </div>\n                    )}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* フォームモーダル */}\n      {isFormOpen && (\n        <AssignmentForm\n          assignment={editingAssignment}\n          staffList={staffList}\n          companies={companies}\n          currentUserId={currentUserId}\n          onClose={() => {\n            setIsFormOpen(false)\n            setEditingAssignment(null)\n          }}\n          onSave={() => {\n            setIsFormOpen(false)\n            setEditingAssignment(null)\n            router.refresh()\n          }}\n        />\n      )}\n    </div>\n  )\n}"],"names":[],"mappings":"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","debugId":null}}]
}